{"remainingRequest":"D:\\SpringBootVueSecondShop\\client\\Snackstore\\node_modules\\babel-loader\\lib\\index.js!D:\\SpringBootVueSecondShop\\client\\Snackstore\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\SpringBootVueSecondShop\\client\\Snackstore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\SpringBootVueSecondShop\\client\\Snackstore\\src\\views\\Commodity.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\SpringBootVueSecondShop\\client\\Snackstore\\src\\views\\Commodity.vue","mtime":1705115326487},{"path":"D:\\SpringBootVueSecondShop\\client\\Snackstore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\SpringBootVueSecondShop\\client\\Snackstore\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\SpringBootVueSecondShop\\client\\Snackstore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\SpringBootVueSecondShop\\client\\Snackstore\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport _defineProperty from \"D:/SpringBootVueSecondShop/client/Snackstore/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport AddSubtractButton from '@/components/AddSubtractButton';\nimport commodityTabComponent from '@/components/CommodityTabComponent';\nimport { mapActions, mapState } from 'vuex';\nexport default {\n  name: 'commodity',\n  data: function data() {\n    return {\n      commodity: {},\n      quantity: 0\n    };\n  },\n  components: {\n    AddSubtractButton: AddSubtractButton,\n    commodityTabComponent: commodityTabComponent\n  },\n  computed: _objectSpread({}, mapState('user', ['user'])),\n  created: function created() {\n    var _this = this;\n\n    var url = this.$route.fullPath;\n\n    if (url.indexOf(\"/shop/commodity\") != -1) {\n      url = \"/commodity/\" + this.$route.params.id;\n    }\n\n    this.axios.get(url).then(function (response) {\n      if (response.status == 200) {\n        _this.commodity = response.data.data;\n\n        if (_this.commodity.bargain == 0) {\n          _this.commodity.bargain = \"不议价\";\n        } else _this.commodity.bargain = \"可以议价\";\n      }\n    }).catch(function (error) {\n      return alert(error);\n    });\n  },\n  methods: _objectSpread({\n    // 子组件AddSubtractButton的自定义事件updateQuantity的处理函数\n    handleUpdate: function handleUpdate(value) {\n      this.quantity = value;\n    },\n    factPrice: function factPrice(price, discount) {\n      return price * discount;\n    },\n    //加入购物车\n    addCart: function addCart(commodity) {\n      var _this2 = this;\n\n      if (!this.user) {\n        this.$router.push(\"/login\");\n        return;\n      }\n\n      var quantity = this.quantity;\n\n      if (quantity === 0) {\n        quantity = 1;\n      }\n\n      if (commodity.inventory < quantity) {\n        this.$message(\"库存不够\");\n        return;\n      }\n\n      this.axios.post('/shoppingCart', {\n        commodityId: commodity.id,\n        quantity: quantity,\n        userId: this.user.id\n      }).then(function (response) {\n        if (response.data.code == 0) {\n          _this2.$router.push('/cart');\n        } else {\n          _this2.$message(\"加入购物车失败\");\n        }\n      }).catch(function (error) {\n        return alert(error);\n      });\n    }\n  }, mapActions('cart', ['addProductToCart'])),\n  filters: {\n    // 格式化折扣数据\n    formatDiscount: function formatDiscount(value) {\n      if (value) {\n        var strDigits = value.toString().substring(2);\n        strDigits += \"折\";\n        return strDigits;\n      } else return value;\n    },\n    formatEmptyData: function formatEmptyData(value) {\n      if (value == null) {\n        value = \"未知\";\n      }\n\n      return value;\n    }\n  }\n};",{"version":3,"sources":["Commodity.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"commodity\">\r\n    <div class=\"img-preview\">\r\n      <img :src=\"this.HOST+commodity.photoOne\" v-if=\"commodity.photoOne\"  />\r\n    </div>\r\n    <div>\r\n      <div class=\"commodityInfo\">\r\n        <h3>{{ commodity.name }}</h3>\r\n        <p>\r\n          <span>商家：{{ commodity.shopName }}</span>\r\n          <span>平均分：{{commodity.score}}</span>\r\n        </p>\r\n        <p>库存：{{ commodity.inventory }}</p>\r\n        <p>新旧程度：{{ commodity.degree | formatEmptyData}}</p>\r\n        <div class=\"bargain\">{{commodity.bargain}}</div>\r\n        <p>\r\n          <span class=\"factPrice\">\r\n            {{ commodity.price | factPrice(commodity.discount) | currency }}\r\n          </span>\r\n          <span v-if=\"commodity.discount!=1\" class=\"discount\">\r\n            [{{commodity.discount  | formatDiscount}}]\r\n          </span>\r\n          <span v-if=\"commodity.discount!=1\">[定价 <i class=\"price\">{{commodity.price | currency}}</i>]</span>\r\n        </p>\r\n        <p>注：一单起拍，一单为租赁一天！</p>\r\n      </div>\r\n      <div class=\"addCart\" v-if=\"user\">\r\n        <AddSubtractButton  :quantity=\"quantity\" @updateQuantity=\"handleUpdate\"/> \r\n        <button class=\"addCartButton\" @click=\"addCart(commodity)\">加入购物车</button>\r\n      </div>\r\n    </div>\r\n    <commodityTabComponent :content=\"commodity.instruction\"/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import AddSubtractButton from '@/components/AddSubtractButton'\r\n  import commodityTabComponent from '@/components/CommodityTabComponent'\r\n  import { mapActions, mapState } from 'vuex'\r\n  export default {\r\n    name: 'commodity',\r\n    data () {\r\n      return {\r\n        commodity: {},\r\n        quantity: 0\r\n      }\r\n    },\r\n    components: {\r\n      AddSubtractButton,\r\n      commodityTabComponent\r\n    },\r\n    computed:{\r\n        ...mapState('user',['user'])\r\n    },\r\n  \r\n    created(){\r\n      let url = this.$route.fullPath;\r\n      if(url.indexOf(\"/shop/commodity\")!=-1){\r\n          url = \"/commodity/\"+this.$route.params.id;\r\n      }\r\n      this.axios.get(url)\r\n        .then(response => {\r\n          if(response.status == 200){\r\n            this.commodity = response.data.data;\r\n            if(this.commodity.bargain==0){\r\n              this.commodity.bargain=\"不议价\";\r\n            }else this.commodity.bargain=\"可以议价\";\r\n          }\r\n        }).catch(error => alert(error));\r\n    },\r\n    methods: {\r\n      // 子组件AddSubtractButton的自定义事件updateQuantity的处理函数\r\n      handleUpdate(value){\r\n        this.quantity = value;\r\n      },\r\n      factPrice(price, discount){\r\n        return price * discount;\r\n      },\r\n      //加入购物车\r\n      addCart(commodity){\r\n        if(!this.user){\r\n          this.$router.push(\"/login\");\r\n          return;\r\n        }\r\n        let quantity = this.quantity;\r\n        \r\n        if(quantity === 0){\r\n          quantity = 1;\r\n        }\r\n        if(commodity.inventory < quantity){\r\n          this.$message(\"库存不够\");\r\n          return;\r\n        }\r\n        this.axios.post('/shoppingCart',{commodityId:commodity.id,quantity:quantity,userId:this.user.id}).then(response => {\r\n          if(response.data.code == 0){\r\n            this.$router.push('/cart');\r\n          }else{\r\n            this.$message(\"加入购物车失败\")\r\n          }\r\n        }).catch(error => alert(error))\r\n        \r\n      },\r\n      ...mapActions('cart', [\r\n        'addProductToCart'\r\n      ])\r\n    },\r\n \r\n    filters: {\r\n      // 格式化折扣数据\r\n      formatDiscount(value){\r\n        if(value)\r\n        {\r\n          let strDigits = value.toString().substring(2);\r\n          strDigits += \"折\";\r\n          return strDigits;\r\n        }\r\n        else\r\n          return value;\r\n      },\r\n      formatEmptyData(value){\r\n        if(value==null){\r\n          value = \"未知\";\r\n        }\r\n        return value;\r\n      }\r\n    }\r\n  }\r\n</script>\r\n<style scoped>\r\n.commodity {\r\n  width: 1200px;\r\n  height: 500px;\r\n  margin: 0 auto;\r\n  margin-top: 60px;\r\n  font-size: 16px;\r\n  text-align: left;\r\n  color: #846e6e;\r\n}\r\n.commodity img {\r\n  margin-left: 50px;\r\n  float: left;\r\n  width: 200px;\r\n  height: 200px;\r\n}\r\n.commodity .commodityInfo {\r\n  margin-left: 20px;\r\n  float: left;\r\n  width: 800px;\r\n  background-color: #eee;\r\n  padding-left: 20px;\r\n  padding-top: 5px;\r\n}\r\n\r\n.commodity .addCart {\r\n  margin-left: 300px;\r\n  float: left;\r\n  margin-top: 10px;\r\n}\r\n.commodity .addCartButton{\r\n\tpadding: 5px 10px 6px;\r\n\tcolor: #fff;\r\n\tborder: none;\r\n\tborder-bottom: solid 1px #222;\r\n\tborder-radius: 5px;\r\n\tbox-shadow: 0 1px 3px #999;\r\n\ttext-shadow: 0 -1px 3px #444;\r\n\tcursor: pointer;\r\n  background-color: #e33100;\r\n  display: block;\r\n  margin-left: 80px;\r\n}\r\n.addCartButton:hover {\r\n  text-shadow: 0 1px 1px #444;\r\n}\r\n\r\n.commodity span{\r\n  padding-right: 15px;\r\n}\r\n\r\n.commodity .price {\r\n  color: gray;\r\n  text-decoration: line-through;\r\n}\r\n.commodity .discount{\r\n  color: red;\r\n}\r\n.commodity .factPrice{\r\n  color: red;\r\n  font-weight: bold;\r\n}\r\n</style>"],"sourceRoot":"src/views"}]}