{"remainingRequest":"D:\\Snackstore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Snackstore\\src\\components\\UserRegister.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\Snackstore\\src\\components\\UserRegister.vue","mtime":1713860986508},{"path":"D:\\Snackstore\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\Snackstore\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Snackstore\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Snackstore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Snackstore\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.register {\r\n  margin: 0 auto;\r\n  padding: 2em 0;\r\n  width: 500px;\r\n}\r\n\r\n.imageVaild{\r\n  position:relative;\r\n}\r\n\r\ncanvas{\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n}\r\n.toMerchantRegister{\r\n  position: relative;\r\n}\r\n.toMerchantRegister a{\r\n  position: absolute;\r\n  top: -50px;\r\n  right: 0;\r\n}\r\na{\r\n  text-decoration: none;\r\n}\r\n",{"version":3,"sources":["UserRegister.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsNA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserRegister.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"register\">\r\n    <el-form :model=\"form\" status-icon :rules=\"rules\" ref=\"form\" label-width=\"100px\" class=\"demo-form\">\r\n       <el-form-item label=\"用户名\" prop=\"name\">\r\n        <el-input type=\"text\" v-model=\"form.name\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"密码\" prop=\"password\">\r\n        <el-input type=\"password\" v-model=\"form.password\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"确认密码\" prop=\"checkPass\">\r\n        <el-input type=\"password\" v-model=\"form.checkPass\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"电话\" prop=\"phone\">\r\n        <el-input type=\"tel\" v-model=\"form.phone\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"邮箱\" prop=\"email\">\r\n        <el-input type=\"email\" v-model=\"form.email\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"城市\" prop=\"city\">\r\n        <el-input type=\"text\" v-model=\"form.city\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"性别\" prop=\"sex\">\r\n        <el-radio-group v-model=\"form.sex\">\r\n          <el-radio label=\"0\">男</el-radio>\r\n          <el-radio label=\"1\">女</el-radio>\r\n        </el-radio-group>\r\n      </el-form-item>\r\n      <el-form-item label=\"银行卡号\" prop=\"card\">\r\n        <el-input type=\"tel\" v-model=\"form.card\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"验证码\" prop=\"imageValid\">\r\n        <el-input type=\"text\" v-model=\"form.imageValid\"></el-input>\r\n        <canvas ref=\"canvas\" id=\"canvas\" width=\"120\" height=\"40\" @click=\"updateCanvas()\"></canvas>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"register('form')\">提交</el-button>\r\n        <el-button @click=\"resetForm('form')\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <div class=\"toMerchantRegister\"><router-link to=\"/sellRegister\">&gt;商家注册</router-link></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"UserRegister\",\r\n  data() {\r\n     var validatePass = (rule, value, callback) => {\r\n        if (value === '') {\r\n          callback(new Error('请输入密码'));\r\n        } else {\r\n          if (this.form.checkPass !== '') {\r\n            this.$refs.form.validateField('checkPass');\r\n          }\r\n          callback();\r\n        }\r\n      };\r\n      var validatePass2 = (rule, value, callback) => {\r\n        if (value === '') {\r\n          callback(new Error('请再次输入密码'));\r\n        } else if (value !== this.form.password) {\r\n          callback(new Error('两次输入密码不一致!'));\r\n        } else {\r\n          callback();\r\n        }\r\n      };\r\n      var validatePass3 = (rule, value, callback) => {\r\n        if(value === ''){\r\n          callback(new Error('验证码不能为空'));\r\n        }else if(value !== this.num){\r\n          this.updateCanvas();\r\n          callback(new Error('验证码输入有误'));\r\n        }else{\r\n          callback();\r\n        }\r\n      }\r\n    return {\r\n      form:{\r\n        name: \"\",\r\n        password: \"\",\r\n        checkPass: \"\",\r\n        phone: \"\",\r\n        email: \"\",\r\n        city: \"\",\r\n        sex: \"\",\r\n        card: \"\",\r\n        imageValid:\"\"  //用户输入的验证码\r\n      },  \r\n      num: \"\", //图片中的随机验证码\r\n      rules: {\r\n        name: [\r\n          {required: true, message: '请输入用户名', trigger: 'blur'}\r\n        ],\r\n        password: [\r\n          { validator: validatePass, trigger: 'blur' }\r\n        ],\r\n        checkPass: [\r\n          { validator: validatePass2, trigger: 'blur' }\r\n        ],\r\n        phone: [\r\n          {required:true, message:\"请输入电话\", trigger: 'blur'},\r\n          {min:11,max:11, message:\"电话号码格式不正确\", trigger: 'blur'}\r\n        ],\r\n        imageValid: [\r\n          {validator: validatePass3, trigger: 'blur'}\r\n        ],\r\n        email:[{required:true, message:\"请输入邮箱地址\", trigger: 'blur'}],\r\n        city:[{required:true, message:\"请输入城市地址\", trigger: 'blur'}],\r\n        card: [\r\n          {required:true, message:\"请输入银行卡号\", trigger: 'blur'},\r\n          {min:16,max:16, message:\"银行卡号格式不正确\", trigger: 'blur'}\r\n        ],\r\n      }\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    //重置表单\r\n    resetForm(formName) {\r\n      this.$refs[formName].resetFields();\r\n    },\r\n\r\n    //提交注册\r\n    register(formName) {\r\n      this.$refs[formName].validate((valid) => {   //表单验证\r\n        if (!valid) {\r\n           return;\r\n        }\r\n        else{\r\n          this.axios.post(\"/user/register\", this.form)\r\n          .then(response => {\r\n            if(response.data.code === 0){\r\n              this.$message({\r\n                message:\"注册成功！\",\r\n                type:\"success\"\r\n              });\r\n              this.resetForm('form');\r\n              this.$router.replace(\"/login\");\r\n            }else{\r\n              this.resetForm('form');\r\n              this.$message(\"该用户名已被注册！\");\r\n            }\r\n          })\r\n          .catch(error => {\r\n            alert(error.message)\r\n          })\r\n        }\r\n      });\r\n    },\r\n\r\n    \r\n    // 随机颜色函数\r\n    getColor() {\r\n        var r = Math.floor(Math.random() * 256);\r\n        var g = Math.floor(Math.random() * 256);\r\n        var b = Math.floor(Math.random() * 256);\r\n        return \"rgb(\" + r + \",\" + g + \",\" + b + \")\";\r\n    },\r\n    draw() {\r\n        var context = this.$refs.canvas.getContext(\"2d\");//舞台，getContext() 方法可返回一个对象，该对象提供了用于在画布上绘图的方法和属性。\r\n        context.strokeRect(0, 0, 120, 40);//绘制矩形（无填充）\r\n        var aCode = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\"];\r\n        // 绘制字母\r\n        var arr = [] //定义一个数组用来接收产生的随机数\r\n        for (var i = 0; i < 4; i++) {\r\n            let x = 20 + i * 20;//每个字母之间间隔20\r\n            let y = 20 + 10 * Math.random();//y轴方向位置为20-30随机\r\n            var index = Math.floor(Math.random() * aCode.length);//随机索引值\r\n            var txt = aCode[index];\r\n            context.font = \"bold 20px 微软雅黑\";//设置或返回文本内容的当前字体属性\r\n            context.fillStyle=this.getColor;//设置或返回用于填充绘画的颜色、渐变或模式，随机\r\n            context.translate(x,y);//重新映射画布上的 (0,0) 位置，字母不可以旋转移动，所以移动容器\r\n            var deg=90*Math.random()*Math.PI/180;//0-90度随机旋转\r\n            context.rotate(deg);//  旋转当前绘图\r\n            context.fillText(txt, 0, 0);//在画布上绘制“被填充的”文本\r\n            context.rotate(-deg);//将画布旋转回初始状态\r\n            context.translate(-x,-y);//将画布移动回初始状态\r\n            arr[i] = txt //接收产生的随机数\r\n        }\r\n        this.num = arr[0] + arr[1] + arr[2] + arr[3] //将产生的验证码放入num\r\n        // 绘制干扰线条\r\n        for (let i = 0; i < 8; i++) {\r\n            context.beginPath();//起始一条路径，或重置当前路径\r\n            context.moveTo(Math.random() * 120, Math.random() * 40);//把路径移动到画布中的随机点，不创建线条\r\n            context.lineTo(Math.random() * 120, Math.random() * 40);//添加一个新点，然后在画布中创建从该点到最后指定点的线条\r\n            context.strokeStyle=this.getColor();//随机线条颜色\r\n            context.stroke();//  绘制已定义的路径\r\n        }\r\n        // 绘制干扰点，和上述步骤一样，此处用长度为1的线代替点\r\n        for (let i = 0; i < 20; i++) {\r\n            context.beginPath();\r\n            let x = Math.random() * 120;\r\n            let y = Math.random() * 40;\r\n            context.moveTo(x, y);\r\n            context.lineTo(x + 1, y + 1);\r\n            context.strokeStyle=this.getColor();\r\n            context.stroke();\r\n        }\r\n    }, \r\n    //更新验证码\r\n    updateCanvas(){\r\n      var context = this.$refs.canvas.getContext(\"2d\");\r\n       context.clearRect(0, 0, 120, 40);//在给定的矩形内清除指定的像素\r\n       this.draw();\r\n       console.log(this.num);\r\n    }\r\n  },\r\n  mounted(){\r\n    this.draw()\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.register {\r\n  margin: 0 auto;\r\n  padding: 2em 0;\r\n  width: 500px;\r\n}\r\n\r\n.imageVaild{\r\n  position:relative;\r\n}\r\n\r\ncanvas{\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n}\r\n.toMerchantRegister{\r\n  position: relative;\r\n}\r\n.toMerchantRegister a{\r\n  position: absolute;\r\n  top: -50px;\r\n  right: 0;\r\n}\r\na{\r\n  text-decoration: none;\r\n}\r\n</style>"]}]}